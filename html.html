<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Anime</title>
    <script src="Script1.js"></script>
    <script src="https://kit.fontawesome.com/944eb371a4.js"></script>
    <script src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="StyleSheet.css" />
</head>
<body>
    <input type="file" id="excel-file" />

    <div id="card-groups"></div>

    <div id="card-swiper-buttons">
        <button onclick="handleLeftButton()">
            <i class="fa-solid fa-arrow-left"></i>
        </button>
        <button onclick="handleRightButton()">
            <i class="fa-solid fa-arrow-right"></i>
        </button>
    </div>

    <script>

        const excelFile = document.getElementById('excel-file');

        excelFile.addEventListener('change', (event) => {

            var reader = new FileReader();

            reader.readAsArrayBuffer(event.target.files[0]);

            reader.onload = function (event) {

                var data = new Uint8Array(reader.result);

                var workBook = XLSX.read(data, { type: 'array' });

                var sheetName = workBook.SheetNames;

                var sheetData = XLSX.utils.sheet_to_json(workBook.Sheets[sheetName[0]], { header: 1 });

                var cardGroups = "";  // card groups
                var cardGroupIndex = -1;

                for (var row = 0; row < sheetData.length; row++) {

                    // if hero exists on row
                    if (sheetData[row][0]) {

                        // card group settings 
                        cardGroupIndex += 1;
                        var cardGroupStatus = cardGroupIndex == 0 ? "active" : "unknown";

                        var cardGroup = `<div class='card-group' data-index='${cardGroupIndex}' data-status='${cardGroupStatus}'>`;  // card group

                        for (var col = 0; col < 8; col++) {

                            // card settings
                            var cardType = col < 4 ? "big-card" : "little-card", cardLink = sheetData[row + col + 1][1];

                            var card = `<div class='card ${cardType}' style='background-image: url(${cardLink})'></div>`;  // card 

                            cardGroup += card;  // adding the card to its group
                        }

                        cardGroup += "</div>";
                        cardGroups += cardGroup;  // adding the card group to the card groups
                    }

                }

                document.getElementById("card-groups").innerHTML = cardGroups;
                console.log(cardGroups);
                groups = document.getElementsByClassName("card-group").length;
            }
        });
    </script>
</body>
</html>
