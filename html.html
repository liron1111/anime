<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Anime</title>
    <script src="Script1.js"></script>
    <script src="https://kit.fontawesome.com/944eb371a4.js"></script>
    <script src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="StyleSheet.css" />
</head>
<body>

    <div id="text-content"></div>

    <div id="card-content">

        <div id="card-groups"></div>

        <div id="card-swiper-buttons">
            <button onclick="handleLeftButton()">
                <i class="fa-solid fa-arrow-left"></i>
            </button>
            <button onclick="handleRightButton()">
                <i class="fa-solid fa-arrow-right"></i>
            </button>
        </div>

    </div>

    <input type="file" id="excel-file" />

    <script>

        const excelFile = document.getElementById('excel-file');

        excelFile.addEventListener('change', (event) => {

            var reader = new FileReader();

            reader.readAsArrayBuffer(event.target.files[0]);

            reader.onload = function (event) {

                var data = new Uint8Array(reader.result);

                var workBook = XLSX.read(data, { type: 'array' });

                // sheet
                var sheetName = workBook.SheetNames;  // name
                var sheetData = XLSX.utils.sheet_to_json(workBook.Sheets[sheetName[0]], { header: 1 });  // data

                var textGroups = "";  // card groups descriptions

                // cards
                var cardGroups = "";
                var currentIndex = -1;

                for (var row = 0; row < sheetData.length; row++) {

                    // if hero exists on row
                    if (sheetData[row][0]) {

                        currentIndex += 1;  // index of group

                        // card group
                        var groupStatus = currentIndex == 0 ? "active" : "unknown";
                        var cardGroup = `<div class='card-group' data-index='${currentIndex}' data-status='${groupStatus}'>`;  // card group

                        var textGroup = `<div class='text-group' text-index='${currentIndex}' data-status='${groupStatus}'>`;  // card group

                        for (var col = 0; col < 8; col++) {

                            var cardType = col < 4 ? "big-card" : "little-card", cardLink = sheetData[row + col + 1][1];
                            var card = `<div class='card ${cardType}' style='background-image: url(${cardLink})'></div>`;  // card

                            cardGroup += card;  // adding card => card group

                            var text = sheetData[row + col + 1][2];
                            if (text) {
                                var textTag = `<p class='text'>${text}</p>`;  // card

                                textGroup += textTag;  // adding text => text group
                            }

                        }

                        cardGroup += "</div>";  // completing tag
                        cardGroups += cardGroup;  // adding card group => card groups

                        textGroup += "</div>";  // completing tag
                        textGroups += textGroup;  // adding text group => text groups
                    }

                }

                document.getElementById("card-groups").innerHTML = cardGroups;
                document.getElementById("text-content").innerHTML = textGroups;
                console.log(textGroups);
                groups = document.getElementsByClassName("card-group").length;

            }
        });
    </script>
</body>
</html>
